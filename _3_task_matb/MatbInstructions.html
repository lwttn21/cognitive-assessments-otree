{{ block title }}Instructions: MATB-II Task{{ endblock }}

{{ block content }}
<style>
.instruction-box {
    border: 1px solid #ccc;
    padding: 20px;
    background-color: #f9f9f9;
    border-radius: 8px;
}
.prio-list {
    background: #fff;
    padding: 10px;
    border-radius: 5px;
    border-left: 5px solid #007bff;
}
</style>

<div class="instruction-box">
    <p>
        In this task, you will operate the <strong>Multi-Attribute Task Battery (MATB-II)</strong> for 10 minutes.
        You will need to manage four subsystems simultaneously. Since it is difficult to handle all tasks perfectly,
        please follow this <strong>priority order</strong>:
    </p>

    <div class="prio-list">
        <ol>
            <li><strong>System Monitoring</strong> (Highest Priority)</li>
            <li><strong>Tracking</strong></li>
            <li><strong>Communications</strong></li>
            <li><strong>Resource Management</strong> (Lowest Priority)</li>
        </ol>
    </div>

    <p class="mt-3">
        Please watch the introduction video below to learn how to operate each subsystem.
        <strong>The "Next" button will appear once the video has finished playing.</strong>
    </p>

    <div id="video-container" style="display: flex; justify-content: center; margin-bottom: 20px;">
        <iframe id="intro-video" width="640" height="360"
            src="https://www.youtube.com/embed/lUe76_7F6jk?enablejsapi=1"
            title="Introduction Video MATB-II"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
        </iframe>
    </div>

    <div id="info-text" class="alert alert-warning text-center">
        Please watch the video to the end to continue.
    </div>

    <div id="next-div" style="display:none;" class="text-center">
        {{ next_button }}
    </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
let player;

// Initialize the YouTube API
function onYouTubeIframeAPIReady() {
    player = new YT.Player('intro-video', {
        events: {
            'onStateChange': onPlayerStateChange
        }
    });
}

// Monitor the video state
function onPlayerStateChange(event) {
    // State 0 means the video has ended
    if(event.data === YT.PlayerState.ENDED){
        document.getElementById('info-text').style.display = 'none';
        document.getElementById('next-div').style.display = 'block';
    }
}
</script>

{{ endblock }}